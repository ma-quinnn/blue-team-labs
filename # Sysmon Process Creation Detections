# Sysmon Process Creation Labs - Windows telemetry Validation
`I deployed Sysmon, generated telemetry, analyzed process creation events, and validated parent-child execution chains`
#### Date and Time: 1/11/2026, 6:29PM to 6:30PM
## Objective:
To validate Sysmon installation and observe process creation events using PowerShell commands.

### Process Create:
`RuleName: -
UtcTime: 2026-01-11 15:29:32.414
ProcessGuid: {d7bf3f9e-c1dc-6963-9e3e-040000002a00}
ProcessId: 13360
Image: C:\Windows\System32\ipconfig.exe
FileVersion: 10.0.26100.7309 (WinBuild.160101.0800)
Description: IP Configuration Utility
Product: Microsoft® Windows® Operating System
Company: Microsoft Corporation
OriginalFileName: ipconfig.exe
CommandLine: "C:\Windows\system32\ipconfig.exe"
CurrentDirectory: C:\Users\test_user\
User: test_user
LogonGuid: {d7bf3f9e-be7b-693e-24cb-750000000000}
LogonId: 0x75CB24
TerminalSessionId: 1
IntegrityLevel: Medium
Hashes: SHA256=AC7966280133DF541509EB0676E4B2F994BAC65E960C79415CCF9F12E17DAC5C
ParentProcessGuid: {d7bf3f9e-c1d1-6963-9c3e-040000002a00}
ParentProcessId: 20336
ParentImage: C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe
ParentCommandLine: powershell.exe
ParentUser: test_user`

### Process Create:
`RuleName: -
UtcTime: 2026-01-11 15:29:28.732
ProcessGuid: {d7bf3f9e-c1d8-6963-9d3e-040000002a00}
ProcessId: 36624
Image: C:\Windows\System32\whoami.exe
FileVersion: 10.0.26100.1882 (WinBuild.160101.0800)
Description: whoami - displays logged on user information
Product: Microsoft® Windows® Operating System
Company: Microsoft Corporation
OriginalFileName: whoami.exe
CommandLine: "C:\Windows\system32\whoami.exe"
CurrentDirectory: C:\Users\test_user\
User: test_user
LogonGuid: {d7bf3f9e-be7b-693e-24cb-750000000000}
LogonId: 0x75CB24
TerminalSessionId: 1
IntegrityLevel: Medium
Hashes: SHA256=23240EF9F8B0A9A324110B1C2331DE31DC1B0E08F5359CB707E51A939AF56CD3
ParentProcessGuid: {d7bf3f9e-c1d1-6963-9c3e-040000002a00}
ParentProcessId: 20336
ParentImage: C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe
ParentCommandLine: powershell.exe
ParentUser: test_user`

### Process Create:
`RuleName: -
UtcTime: 2026-01-11 15:29:21.939
ProcessGuid: {d7bf3f9e-c1d1-6963-9c3e-040000002a00}
ProcessId: 20336
Image: C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe
FileVersion: 10.0.26100.5074 (WinBuild.160101.0800)
Description: Windows PowerShell
Product: Microsoft® Windows® Operating System
Company: Microsoft Corporation
OriginalFileName: PowerShell.EXE
CommandLine: powershell.exe
CurrentDirectory: C:\Users\test_user\
User: test_user
LogonGuid: {d7bf3f9e-be7b-693e-24cb-750000000000}
LogonId: 0x75CB24
TerminalSessionId: 1
IntegrityLevel: Medium
Hashes: SHA256=0FF6F2C94BC7E2833A5F7E16DE1622E5DBA70396F31C7D5F56381870317E8C46
ParentProcessGuid: {d7bf3f9e-c11b-6963-8c3e-040000002a00}
ParentProcessId: 3924
ParentImage: C:\Windows\System32\cmd.exe
ParentCommandLine: "C:\Windows\system32\cmd.exe"
ParentUser: test_user`

## Environment:
- OS: Windows 11
- Tool: Sysmon
- Log Source: Microsoft-Windows-Sysmon/Operational
## Steps Performed:
1. Verified Sysmon service was running using `sc query sysmon64`
2. Executed `powershell.exe`
3. Ran commands:
	- `whoami`
	- `ipconfig`
4. Opened Event Viewer > Sysmon Operational logs
5. Filtered for Event ID 1 (Process Create)
## Results Observed:
- Detected powershell.exe execution
- Detected child processes:
	- `whoami.exe`
	- `ipconfig.exe`
- Verified parent-child relationships:
	- cmd.exe > powershell.exe > whoami.exe/ipconfig.exe
## Analysis:
	These events demonstrate successful telemetry capture of process execution  and command-line activity. This visibility is critical for detecting living-off-the-land techniques used by attackers.
## Learning Outcome:
	- Understood process creation logging
	- Learned to analyze parent-child relationships
	- Validated Sysmon pipeline functionality

## PART 1 - What I actually did (SOC language)

When I ran : powershell.exe, whoami, ipconfig
- I did a 3 critical things from a defender perspective:
	1. Spawned a scripting engine (PowerShell)
	2. Enumerated user context (whoami)
	3. Enumerated network configuration (ipconfig)
- To attackers, this is:
	Reconnaisssance phase
- To SOC analysts, this is:
	 Initial telemetry of possible intrusion activity
`*So even though its benign, the behavior pattern is attacker-like.`

## PART 2 - Why PowerShell is important in Cybersecurity

PowerShell is:
	Built into Windows
	Trusted by the OS
	Extremely powerful
	Used by attackers more than malware EXEs
*This is called: Living Off The Land (LOLBins)

Attackers love PwerShell because:
	No download needed
	No antivirus trigger
	Blends with normal admin activity

When :
	ParentImage: cmd.exe
	Image: powershell.exe
`*Brain should go "hmm, why is powershell being launched here?"`
#### This is SIGNAL, not noise.

## PART 3 - Understanding the anatomy of my Sysmon Event

Image: `powershell.exe`
ParentImage: `cmd.exe`
CommandLind: `powershell.exe`
User: test_user
IntegrityLevel: Medium

#### Analyst Interpretation:
FIELD				WHY IT MATTERS

-Image				- What executed

-ParentImage		- Who launched it

-CommandLine		- How it was used

-User				- Which account is involved

-IntegrityLevel		- Privilege level

`*WHO did WHAT, HOW, and from WHERE`
#### This is the CORE of Incident Triage.

## PART 4 - Incident Triage Anatomy

CONTEXT
Ask:
	- Is this user an IT admin?
	- Is this during business hours?
	- Is this normal for this role?
if:
	HR staff launching PowerShell at 2AM
	That's Suspicious
if:
	IT admin running scripts at 10AM
	That's probably normal

### PARENT-CHILD RELATIONSHIP
	- Abnormal chain
`cmd.exe->powershell.exe->whoami.exe/ipconfig.exe`
`*This execution chain analysis`
Always ask: "Does this chain make sense?"
	- Normal chain
explorer.exe->cmd.exe->powershell.exe
	- Suspicious chain
winword.exe->powershell.exe
`*Possible macro attack`

### COMMAND-LINE
*Critical
	( `powershell.exe` )
	CLEAN Command - "No obfuscation. Likely interactive"
Example of encoded command > likely malicious
	( `powershell.exe -enc SQBFAFgAIAAoACgA....` )

### USER & PRIVILEGE
IntegrityLevel: Medium
User: test_user

- Medium = Normal
- Not SYSTEM
- Not ADMINISTRATOR
`*"Low privilege. Limited impact."`

Example of high risk:
User: SYSTEM
IntegrityLevel: High

### FREQUENCY & BEHAVIOR
- Is this happening once?
- Or 500 times?
- On one host or many?

One PowerShell = FINE
PowerShell on 30 endpoints = INCIDENT

## PART 5 - MAPPING

`STAGES				COMMAND
-Initial Access		-powershell.exe
-Discovery			-whoami
-Discovery			-ipconfig`

## FRAMEWORKS: MITRE ATT&CK
-T1059: Command and Scripting Interpreter
-T1033: Account Discovery
-T1016: Network Configuration Discovery
